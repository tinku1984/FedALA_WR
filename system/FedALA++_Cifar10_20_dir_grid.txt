==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10
num_classes = 10
model = CNN
batch_size = 10
local_learning_rate = 0.005
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 10
local_epochs = 1
algorithm = FedALA++
join_ratio = 1.0
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = True
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
ewc_lambda = 0.1
buffer_size = 10
grid_search = True
==================================================
args :  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.1, buffer_size=10, grid_search=True)
Testing with buffer_size=10, ewc_lambda=0.05
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.05, buffer_size=10, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3039
Averaged Test Accurancy: 0.0937
Averaged Test AUC: 0.4940
Std Test Accurancy: 0.1815
Std Test AUC: 0.2182
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.415738582611084
Client: 0 	Std: 0.02157117829074438 	ALA epochs: 11
Client: 1 	Std: 0.046165662136549664 	ALA epochs: 11
Client: 2 	Std: 0.0498362570286977 	ALA epochs: 11
Client: 3 	Std: 0.06540574914512168 	ALA epochs: 11
Client: 4 	Std: 0.03005042089498649 	ALA epochs: 11
Client: 5 	Std: 0.03254623757824001 	ALA epochs: 11
Client: 6 	Std: 0.09202532767263055 	ALA epochs: 11
Client: 7 	Std: 0.07534214367085461 	ALA epochs: 11
Client: 8 	Std: 0.049963871050341536 	ALA epochs: 11
Client: 9 	Std: 0.04185221790819658 	ALA epochs: 11
Client: 10 	Std: 0.09749130333986403 	ALA epochs: 11
Client: 11 	Std: 0.05482218764444304 	ALA epochs: 11
Client: 12 	Std: 0.05353604891455614 	ALA epochs: 11
Client: 13 	Std: 0.05208358825524986 	ALA epochs: 11
Client: 14 	Std: 0.04063539753066642 	ALA epochs: 11
Client: 15 	Std: 0.047272071897626 	ALA epochs: 11
Client: 16 	Std: 0.055191323576622354 	ALA epochs: 11
Client: 17 	Std: 0.03329404313991646 	ALA epochs: 11
Client: 18 	Std: 0.03928376118922652 	ALA epochs: 11
Client: 19 	Std: 0.03766346651369169 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.0871
Averaged Test Accurancy: 0.7792
Averaged Test AUC: 0.9635
Std Test Accurancy: 0.1991
Std Test AUC: 0.0349
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 21.040311098098755

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6439
Averaged Test Accurancy: 0.8081
Averaged Test AUC: 0.9679
Std Test Accurancy: 0.1793
Std Test AUC: 0.0341
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.820896625518799

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5473
Averaged Test Accurancy: 0.8257
Averaged Test AUC: 0.9715
Std Test Accurancy: 0.1569
Std Test AUC: 0.0332
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.407180547714233

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5059
Averaged Test Accurancy: 0.8321
Averaged Test AUC: 0.9735
Std Test Accurancy: 0.1526
Std Test AUC: 0.0321
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.725098848342896

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4739
Averaged Test Accurancy: 0.8387
Averaged Test AUC: 0.9748
Std Test Accurancy: 0.1432
Std Test AUC: 0.0310
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.672329664230347

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4535
Averaged Test Accurancy: 0.8423
Averaged Test AUC: 0.9755
Std Test Accurancy: 0.1399
Std Test AUC: 0.0302
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.728997468948364

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4330
Averaged Test Accurancy: 0.8490
Averaged Test AUC: 0.9764
Std Test Accurancy: 0.1367
Std Test AUC: 0.0294
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.208192586898804

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4175
Averaged Test Accurancy: 0.8556
Averaged Test AUC: 0.9770
Std Test Accurancy: 0.1282
Std Test AUC: 0.0283
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.803288698196411

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4049
Averaged Test Accurancy: 0.8598
Averaged Test AUC: 0.9773
Std Test Accurancy: 0.1276
Std Test AUC: 0.0279
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.675354480743408

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.3936
Averaged Test Accurancy: 0.8630
Averaged Test AUC: 0.9777
Std Test Accurancy: 0.1261
Std Test AUC: 0.0275
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
self ewc lambda:0.05, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.684666872024536

Best accuracy.
0.8630456514495168

Average time cost per round.
11.876631689071655
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 135.08s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8630456514495168
global accuracy ++++++++++++++++++++:  0.8630456514495168
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 277768470 	Used Memory: 530.07M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=10, ewc_lambda=0.05, accuracy=0.8630
Testing with buffer_size=10, ewc_lambda=0.1
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.1, buffer_size=10, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3041
Averaged Test Accurancy: 0.1146
Averaged Test AUC: 0.5013
Std Test Accurancy: 0.1488
Std Test AUC: 0.2295
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.750236988067627
Client: 0 	Std: 0.048292578005498944 	ALA epochs: 11
Client: 1 	Std: 0.07687660649735571 	ALA epochs: 11
Client: 2 	Std: 0.040535503883130444 	ALA epochs: 11
Client: 3 	Std: 0.0759842535878453 	ALA epochs: 11
Client: 4 	Std: 0.03896798101172293 	ALA epochs: 11
Client: 5 	Std: 0.033904152630810105 	ALA epochs: 11
Client: 6 	Std: 0.09049085924150684 	ALA epochs: 12
Client: 7 	Std: 0.04926547800736812 	ALA epochs: 11
Client: 8 	Std: 0.054127875148128224 	ALA epochs: 11
Client: 9 	Std: 0.037477233622114095 	ALA epochs: 11
Client: 10 	Std: 0.09832591934979533 	ALA epochs: 11
Client: 11 	Std: 0.08830540412266784 	ALA epochs: 11
Client: 12 	Std: 0.04124944794881686 	ALA epochs: 11
Client: 13 	Std: 0.036292806974828236 	ALA epochs: 11
Client: 14 	Std: 0.049938127481922244 	ALA epochs: 11
Client: 15 	Std: 0.06577198493152275 	ALA epochs: 11
Client: 16 	Std: 0.026110103332839314 	ALA epochs: 11
Client: 17 	Std: 0.03907658228036247 	ALA epochs: 11
Client: 18 	Std: 0.041953381763258024 	ALA epochs: 11
Client: 19 	Std: 0.040329417429637485 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1059
Averaged Test Accurancy: 0.7761
Averaged Test AUC: 0.9621
Std Test Accurancy: 0.1889
Std Test AUC: 0.0401
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 20.260534286499023

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6483
Averaged Test Accurancy: 0.8130
Averaged Test AUC: 0.9690
Std Test Accurancy: 0.1697
Std Test AUC: 0.0363
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.426508665084839

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5435
Averaged Test Accurancy: 0.8219
Averaged Test AUC: 0.9719
Std Test Accurancy: 0.1648
Std Test AUC: 0.0342
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.517788171768188

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5041
Averaged Test Accurancy: 0.8322
Averaged Test AUC: 0.9738
Std Test Accurancy: 0.1507
Std Test AUC: 0.0325
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.533098220825195

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4788
Averaged Test Accurancy: 0.8337
Averaged Test AUC: 0.9749
Std Test Accurancy: 0.1494
Std Test AUC: 0.0315
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.57458782196045

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4561
Averaged Test Accurancy: 0.8419
Averaged Test AUC: 0.9754
Std Test Accurancy: 0.1406
Std Test AUC: 0.0308
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.545284509658813

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4403
Averaged Test Accurancy: 0.8459
Averaged Test AUC: 0.9763
Std Test Accurancy: 0.1392
Std Test AUC: 0.0295
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.48367166519165

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4246
Averaged Test Accurancy: 0.8496
Averaged Test AUC: 0.9769
Std Test Accurancy: 0.1357
Std Test AUC: 0.0291
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.590109586715698

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4168
Averaged Test Accurancy: 0.8552
Averaged Test AUC: 0.9770
Std Test Accurancy: 0.1321
Std Test AUC: 0.0286
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.569944381713867

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4055
Averaged Test Accurancy: 0.8583
Averaged Test AUC: 0.9777
Std Test Accurancy: 0.1274
Std Test AUC: 0.0278
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
self ewc lambda:0.1, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.524652004241943

Best accuracy.
0.8583138953682106

Average time cost per round.
11.602617931365966
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 131.08s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8583138953682106
global accuracy ++++++++++++++++++++:  0.8583138953682106
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 277768470 	Used Memory: 530.07M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=10, ewc_lambda=0.1, accuracy=0.8583
Testing with buffer_size=10, ewc_lambda=0.2
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.2, buffer_size=10, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3023
Averaged Test Accurancy: 0.1022
Averaged Test AUC: 0.5041
Std Test Accurancy: 0.1314
Std Test AUC: 0.2259
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.598928213119507
Client: 0 	Std: 0.024689347152139048 	ALA epochs: 11
Client: 1 	Std: 0.061298738539461765 	ALA epochs: 11
Client: 2 	Std: 0.0582695474531113 	ALA epochs: 11
Client: 3 	Std: 0.04644650591658547 	ALA epochs: 11
Client: 4 	Std: 0.02994115524219892 	ALA epochs: 11
Client: 5 	Std: 0.03297729907493694 	ALA epochs: 11
Client: 6 	Std: 0.09553886836010525 	ALA epochs: 11
Client: 7 	Std: 0.054326019600364574 	ALA epochs: 11
Client: 8 	Std: 0.03768225099925525 	ALA epochs: 11
Client: 9 	Std: 0.0018148787718288996 	ALA epochs: 11
Client: 10 	Std: 0.07690305129148842 	ALA epochs: 12
Client: 11 	Std: 0.08168190498032432 	ALA epochs: 12
Client: 12 	Std: 0.0321239594172494 	ALA epochs: 11
Client: 13 	Std: 0.057480158556522463 	ALA epochs: 11
Client: 14 	Std: 0.037162850172359194 	ALA epochs: 11
Client: 15 	Std: 0.07811133933373832 	ALA epochs: 11
Client: 16 	Std: 0.02580224927018173 	ALA epochs: 11
Client: 17 	Std: 0.03580001378270267 	ALA epochs: 11
Client: 18 	Std: 0.040137160773002376 	ALA epochs: 11
Client: 19 	Std: 0.04084735720361701 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1643
Averaged Test Accurancy: 0.7823
Averaged Test AUC: 0.9641
Std Test Accurancy: 0.1973
Std Test AUC: 0.0345
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 20.2197265625

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6614
Averaged Test Accurancy: 0.8033
Averaged Test AUC: 0.9684
Std Test Accurancy: 0.1833
Std Test AUC: 0.0332
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 12.00885820388794

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5574
Averaged Test Accurancy: 0.8184
Averaged Test AUC: 0.9718
Std Test Accurancy: 0.1640
Std Test AUC: 0.0324
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.970684289932251

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5136
Averaged Test Accurancy: 0.8283
Averaged Test AUC: 0.9735
Std Test Accurancy: 0.1529
Std Test AUC: 0.0314
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 12.053157329559326

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4866
Averaged Test Accurancy: 0.8343
Averaged Test AUC: 0.9746
Std Test Accurancy: 0.1477
Std Test AUC: 0.0307
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.05721139907837

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4655
Averaged Test Accurancy: 0.8399
Averaged Test AUC: 0.9756
Std Test Accurancy: 0.1413
Std Test AUC: 0.0304
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 12.002336025238037

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4508
Averaged Test Accurancy: 0.8461
Averaged Test AUC: 0.9758
Std Test Accurancy: 0.1388
Std Test AUC: 0.0300
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.048287868499756

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4335
Averaged Test Accurancy: 0.8497
Averaged Test AUC: 0.9766
Std Test Accurancy: 0.1351
Std Test AUC: 0.0293
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.968542337417603

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4221
Averaged Test Accurancy: 0.8517
Averaged Test AUC: 0.9770
Std Test Accurancy: 0.1342
Std Test AUC: 0.0289
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.0629403591156

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4123
Averaged Test Accurancy: 0.8562
Averaged Test AUC: 0.9770
Std Test Accurancy: 0.1315
Std Test AUC: 0.0287
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
self ewc lambda:0.2, Buffer size 10
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 12.3764808177948

Best accuracy.
0.8561812729090303

Average time cost per round.
12.076822519302368
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 135.7s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8561812729090303
global accuracy ++++++++++++++++++++:  0.8561812729090303
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 277768470 	Used Memory: 530.07M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=10, ewc_lambda=0.2, accuracy=0.8562
Testing with buffer_size=20, ewc_lambda=0.05
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.05, buffer_size=20, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accurancy: 0.0904
Averaged Test AUC: 0.4897
Std Test Accurancy: 0.1660
Std Test AUC: 0.2177
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.992600440979004
Client: 0 	Std: 0.07194564074675791 	ALA epochs: 11
Client: 1 	Std: 0.059516788651892465 	ALA epochs: 11
Client: 2 	Std: 0.05929830817722218 	ALA epochs: 11
Client: 3 	Std: 0.07124575162330499 	ALA epochs: 11
Client: 4 	Std: 0.0388523885182258 	ALA epochs: 11
Client: 5 	Std: 0.03657788252459521 	ALA epochs: 11
Client: 6 	Std: 0.07898969237082892 	ALA epochs: 12
Client: 7 	Std: 0.04941751045052857 	ALA epochs: 11
Client: 8 	Std: 0.06250969798572491 	ALA epochs: 11
Client: 9 	Std: 0.033051428265562614 	ALA epochs: 11
Client: 10 	Std: 0.08850910973585038 	ALA epochs: 11
Client: 11 	Std: 0.07020098816192882 	ALA epochs: 11
Client: 12 	Std: 0.033999359862111674 	ALA epochs: 11
Client: 13 	Std: 0.06033820876314794 	ALA epochs: 11
Client: 14 	Std: 0.04783990464904884 	ALA epochs: 11
Client: 15 	Std: 0.05585907367294321 	ALA epochs: 11
Client: 16 	Std: 0.026284447907491862 	ALA epochs: 11
Client: 17 	Std: 0.03200272975768077 	ALA epochs: 11
Client: 18 	Std: 0.03942884033797095 	ALA epochs: 11
Client: 19 	Std: 0.036690854102673885 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1123
Averaged Test Accurancy: 0.7751
Averaged Test AUC: 0.9640
Std Test Accurancy: 0.1858
Std Test AUC: 0.0377
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.663320302963257

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6523
Averaged Test Accurancy: 0.8115
Averaged Test AUC: 0.9695
Std Test Accurancy: 0.1710
Std Test AUC: 0.0352
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.738375902175903

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5491
Averaged Test Accurancy: 0.8270
Averaged Test AUC: 0.9728
Std Test Accurancy: 0.1571
Std Test AUC: 0.0332
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.075725078582764

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5012
Averaged Test Accurancy: 0.8345
Averaged Test AUC: 0.9743
Std Test Accurancy: 0.1491
Std Test AUC: 0.0322
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.12860107421875

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4767
Averaged Test Accurancy: 0.8396
Averaged Test AUC: 0.9750
Std Test Accurancy: 0.1420
Std Test AUC: 0.0316
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.096893072128296

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4501
Averaged Test Accurancy: 0.8435
Averaged Test AUC: 0.9760
Std Test Accurancy: 0.1405
Std Test AUC: 0.0305
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.092381000518799

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4346
Averaged Test Accurancy: 0.8465
Averaged Test AUC: 0.9765
Std Test Accurancy: 0.1445
Std Test AUC: 0.0301
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.137804746627808

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4183
Averaged Test Accurancy: 0.8530
Averaged Test AUC: 0.9770
Std Test Accurancy: 0.1421
Std Test AUC: 0.0297
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.978766202926636

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4039
Averaged Test Accurancy: 0.8586
Averaged Test AUC: 0.9774
Std Test Accurancy: 0.1313
Std Test AUC: 0.0290
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.196876764297485

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.3940
Averaged Test Accurancy: 0.8624
Averaged Test AUC: 0.9781
Std Test Accurancy: 0.1268
Std Test AUC: 0.0283
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
self ewc lambda:0.05, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.049391031265259

Best accuracy.
0.8624458513828723

Average time cost per round.
11.115813517570496
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 126.48s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8624458513828723
global accuracy ++++++++++++++++++++:  0.8624458513828723
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 278997670 	Used Memory: 532.52M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=20, ewc_lambda=0.05, accuracy=0.8624
Testing with buffer_size=20, ewc_lambda=0.1
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.1, buffer_size=20, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3023
Averaged Test Accurancy: 0.1022
Averaged Test AUC: 0.5041
Std Test Accurancy: 0.1314
Std Test AUC: 0.2259
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.686621189117432
Client: 0 	Std: 0.04666774775764263 	ALA epochs: 11
Client: 1 	Std: 0.06182399623003801 	ALA epochs: 11
Client: 2 	Std: 0.06841053378562258 	ALA epochs: 11
Client: 3 	Std: 0.08493378509763971 	ALA epochs: 11
Client: 4 	Std: 0.029568595329775522 	ALA epochs: 11
Client: 5 	Std: 0.0299211250570702 	ALA epochs: 11
Client: 6 	Std: 0.08336518031916233 	ALA epochs: 11
Client: 7 	Std: 0.024428007359848184 	ALA epochs: 11
Client: 8 	Std: 0.04446818672277762 	ALA epochs: 11
Client: 9 	Std: 0.06719727962734683 	ALA epochs: 11
Client: 10 	Std: 0.06747873519681213 	ALA epochs: 11
Client: 11 	Std: 0.053063026260309905 	ALA epochs: 11
Client: 12 	Std: 0.03330455240028925 	ALA epochs: 11
Client: 13 	Std: 0.09063510507221764 	ALA epochs: 11
Client: 14 	Std: 0.040250737806191234 	ALA epochs: 11
Client: 15 	Std: 0.060715323185238514 	ALA epochs: 11
Client: 16 	Std: 0.029891676399780336 	ALA epochs: 11
Client: 17 	Std: 0.03607339598548836 	ALA epochs: 11
Client: 18 	Std: 0.0425313319794171 	ALA epochs: 11
Client: 19 	Std: 0.039996424964738986 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1482
Averaged Test Accurancy: 0.7818
Averaged Test AUC: 0.9648
Std Test Accurancy: 0.1895
Std Test AUC: 0.0333
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 20.49480438232422

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6479
Averaged Test Accurancy: 0.8103
Averaged Test AUC: 0.9696
Std Test Accurancy: 0.1726
Std Test AUC: 0.0328
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.6496000289917

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5498
Averaged Test Accurancy: 0.8235
Averaged Test AUC: 0.9721
Std Test Accurancy: 0.1557
Std Test AUC: 0.0323
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.981095552444458

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5098
Averaged Test Accurancy: 0.8296
Averaged Test AUC: 0.9741
Std Test Accurancy: 0.1512
Std Test AUC: 0.0314
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.917330980300903

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4851
Averaged Test Accurancy: 0.8366
Averaged Test AUC: 0.9751
Std Test Accurancy: 0.1447
Std Test AUC: 0.0304
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.979979753494263

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4605
Averaged Test Accurancy: 0.8428
Averaged Test AUC: 0.9757
Std Test Accurancy: 0.1425
Std Test AUC: 0.0303
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.973371982574463

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4428
Averaged Test Accurancy: 0.8480
Averaged Test AUC: 0.9762
Std Test Accurancy: 0.1372
Std Test AUC: 0.0299
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.00047254562378

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4306
Averaged Test Accurancy: 0.8536
Averaged Test AUC: 0.9766
Std Test Accurancy: 0.1346
Std Test AUC: 0.0290
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.344388723373413

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4179
Averaged Test Accurancy: 0.8569
Averaged Test AUC: 0.9769
Std Test Accurancy: 0.1299
Std Test AUC: 0.0288
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.481285810470581

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4059
Averaged Test Accurancy: 0.8578
Averaged Test AUC: 0.9775
Std Test Accurancy: 0.1286
Std Test AUC: 0.0285
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
self ewc lambda:0.1, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.413950681686401

Best accuracy.
0.857847384205265

Average time cost per round.
11.823628044128418
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 133.31s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.857847384205265
global accuracy ++++++++++++++++++++:  0.857847384205265
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 278997670 	Used Memory: 532.52M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=20, ewc_lambda=0.1, accuracy=0.8578
Testing with buffer_size=20, ewc_lambda=0.2
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.2, buffer_size=20, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3041
Averaged Test Accurancy: 0.1146
Averaged Test AUC: 0.5013
Std Test Accurancy: 0.1488
Std Test AUC: 0.2295
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.471126079559326
Client: 0 	Std: 0.03847529263353043 	ALA epochs: 11
Client: 1 	Std: 0.05108642575248832 	ALA epochs: 11
Client: 2 	Std: 0.049255245276318325 	ALA epochs: 11
Client: 3 	Std: 0.08180834445128403 	ALA epochs: 11
Client: 4 	Std: 0.036417146752468 	ALA epochs: 11
Client: 5 	Std: 0.03375921129152582 	ALA epochs: 11
Client: 6 	Std: 0.08449615791933848 	ALA epochs: 12
Client: 7 	Std: 0.047163545763032645 	ALA epochs: 11
Client: 8 	Std: 0.05523528683590603 	ALA epochs: 11
Client: 9 	Std: 0.024337189143916547 	ALA epochs: 11
Client: 10 	Std: 0.08408706940650838 	ALA epochs: 11
Client: 11 	Std: 0.09735021623159854 	ALA epochs: 11
Client: 12 	Std: 0.03754289875088094 	ALA epochs: 11
Client: 13 	Std: 0.03423161870153726 	ALA epochs: 11
Client: 14 	Std: 0.04847162843841027 	ALA epochs: 11
Client: 15 	Std: 0.07396158351586388 	ALA epochs: 11
Client: 16 	Std: 0.04931365691896036 	ALA epochs: 11
Client: 17 	Std: 0.04066795950712134 	ALA epochs: 11
Client: 18 	Std: 0.037762526446221786 	ALA epochs: 11
Client: 19 	Std: 0.040549874696619435 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1284
Averaged Test Accurancy: 0.7770
Averaged Test AUC: 0.9609
Std Test Accurancy: 0.2033
Std Test AUC: 0.0423
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.75067138671875

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6385
Averaged Test Accurancy: 0.8081
Averaged Test AUC: 0.9684
Std Test Accurancy: 0.1778
Std Test AUC: 0.0361
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.985658407211304

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5440
Averaged Test Accurancy: 0.8176
Averaged Test AUC: 0.9719
Std Test Accurancy: 0.1726
Std Test AUC: 0.0339
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.45067834854126

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5086
Averaged Test Accurancy: 0.8281
Averaged Test AUC: 0.9734
Std Test Accurancy: 0.1568
Std Test AUC: 0.0326
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.3078031539917

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4826
Averaged Test Accurancy: 0.8349
Averaged Test AUC: 0.9743
Std Test Accurancy: 0.1448
Std Test AUC: 0.0316
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.15232253074646

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4622
Averaged Test Accurancy: 0.8395
Averaged Test AUC: 0.9751
Std Test Accurancy: 0.1409
Std Test AUC: 0.0305
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.366212844848633

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4467
Averaged Test Accurancy: 0.8433
Averaged Test AUC: 0.9758
Std Test Accurancy: 0.1390
Std Test AUC: 0.0295
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.04002594947815

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4351
Averaged Test Accurancy: 0.8479
Averaged Test AUC: 0.9762
Std Test Accurancy: 0.1368
Std Test AUC: 0.0294
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.994976282119751

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4228
Averaged Test Accurancy: 0.8503
Averaged Test AUC: 0.9766
Std Test Accurancy: 0.1402
Std Test AUC: 0.0289
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.068588495254517

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4136
Averaged Test Accurancy: 0.8554
Averaged Test AUC: 0.9771
Std Test Accurancy: 0.1309
Std Test AUC: 0.0286
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
self ewc lambda:0.2, Buffer size 20
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.073722839355469

Best accuracy.
0.8553815394868377

Average time cost per round.
11.2190660238266
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 127.07s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8553815394868377
global accuracy ++++++++++++++++++++:  0.8553815394868377
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 278997670 	Used Memory: 532.52M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=20, ewc_lambda=0.2, accuracy=0.8554
Testing with buffer_size=50, ewc_lambda=0.05
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.05, buffer_size=50, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3023
Averaged Test Accurancy: 0.1022
Averaged Test AUC: 0.5041
Std Test Accurancy: 0.1314
Std Test AUC: 0.2259
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.589595317840576
Client: 0 	Std: 0.008087816891971276 	ALA epochs: 11
Client: 1 	Std: 0.06074866285324522 	ALA epochs: 11
Client: 2 	Std: 0.068357422945755 	ALA epochs: 11
Client: 3 	Std: 0.0736439840401902 	ALA epochs: 11
Client: 4 	Std: 0.029077055943848146 	ALA epochs: 11
Client: 5 	Std: 0.02958380921165593 	ALA epochs: 11
Client: 6 	Std: 0.09212773047746158 	ALA epochs: 11
Client: 7 	Std: 0.05797006176252428 	ALA epochs: 11
Client: 8 	Std: 0.03747802357140531 	ALA epochs: 11
Client: 9 	Std: 0.085946424260969 	ALA epochs: 11
Client: 10 	Std: 0.07474054498871323 	ALA epochs: 12
Client: 11 	Std: 0.08050624701322713 	ALA epochs: 11
Client: 12 	Std: 0.04911973295639454 	ALA epochs: 11
Client: 13 	Std: 0.04989032519126799 	ALA epochs: 11
Client: 14 	Std: 0.0362564746354033 	ALA epochs: 11
Client: 15 	Std: 0.054445072962020835 	ALA epochs: 11
Client: 16 	Std: 0.02793664690644582 	ALA epochs: 11
Client: 17 	Std: 0.03636023121728269 	ALA epochs: 11
Client: 18 	Std: 0.043117147160826305 	ALA epochs: 11
Client: 19 	Std: 0.039034396412836715 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1443
Averaged Test Accurancy: 0.7657
Averaged Test AUC: 0.9643
Std Test Accurancy: 0.2030
Std Test AUC: 0.0345
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.847211599349976

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6683
Averaged Test Accurancy: 0.8000
Averaged Test AUC: 0.9690
Std Test Accurancy: 0.1768
Std Test AUC: 0.0334
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.49787425994873

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5579
Averaged Test Accurancy: 0.8221
Averaged Test AUC: 0.9721
Std Test Accurancy: 0.1617
Std Test AUC: 0.0322
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.622474193572998

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5038
Averaged Test Accurancy: 0.8300
Averaged Test AUC: 0.9741
Std Test Accurancy: 0.1514
Std Test AUC: 0.0316
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.721365451812744

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4792
Averaged Test Accurancy: 0.8380
Averaged Test AUC: 0.9751
Std Test Accurancy: 0.1423
Std Test AUC: 0.0307
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.639132499694824

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4576
Averaged Test Accurancy: 0.8419
Averaged Test AUC: 0.9758
Std Test Accurancy: 0.1416
Std Test AUC: 0.0300
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.623816728591919

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4414
Averaged Test Accurancy: 0.8507
Averaged Test AUC: 0.9762
Std Test Accurancy: 0.1355
Std Test AUC: 0.0294
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.147146940231323

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4298
Averaged Test Accurancy: 0.8542
Averaged Test AUC: 0.9764
Std Test Accurancy: 0.1332
Std Test AUC: 0.0291
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 12.163870573043823

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4166
Averaged Test Accurancy: 0.8564
Averaged Test AUC: 0.9768
Std Test Accurancy: 0.1302
Std Test AUC: 0.0290
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.157936334609985

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4053
Averaged Test Accurancy: 0.8596
Averaged Test AUC: 0.9771
Std Test Accurancy: 0.1302
Std Test AUC: 0.0284
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
self ewc lambda:0.05, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 12.004680395126343

Best accuracy.
0.8595801399533489

Average time cost per round.
11.842550897598267
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 133.41s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8595801399533489
global accuracy ++++++++++++++++++++:  0.8595801399533489
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 282685270 	Used Memory: 539.84M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=50, ewc_lambda=0.05, accuracy=0.8596
Testing with buffer_size=50, ewc_lambda=0.1
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.1, buffer_size=50, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3023
Averaged Test Accurancy: 0.1022
Averaged Test AUC: 0.5041
Std Test Accurancy: 0.1314
Std Test AUC: 0.2259
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.505903482437134
Client: 0 	Std: 0.05239399593409641 	ALA epochs: 11
Client: 1 	Std: 0.06602619104421364 	ALA epochs: 11
Client: 2 	Std: 0.0683068643491182 	ALA epochs: 11
Client: 3 	Std: 0.06087807220347385 	ALA epochs: 11
Client: 4 	Std: 0.029568533909557923 	ALA epochs: 11
Client: 5 	Std: 0.02075397574682584 	ALA epochs: 11
Client: 6 	Std: 0.09153137809273117 	ALA epochs: 11
Client: 7 	Std: 0.03396047536647703 	ALA epochs: 11
Client: 8 	Std: 0.036292008360142174 	ALA epochs: 11
Client: 9 	Std: 0.010034261742208447 	ALA epochs: 11
Client: 10 	Std: 0.08219329175556554 	ALA epochs: 12
Client: 11 	Std: 0.06280940390474649 	ALA epochs: 11
Client: 12 	Std: 0.05208632738407802 	ALA epochs: 11
Client: 13 	Std: 0.06170544370530866 	ALA epochs: 11
Client: 14 	Std: 0.0413013733100655 	ALA epochs: 11
Client: 15 	Std: 0.05780053965163165 	ALA epochs: 11
Client: 16 	Std: 0.05677135166195649 	ALA epochs: 11
Client: 17 	Std: 0.035215552314790594 	ALA epochs: 11
Client: 18 	Std: 0.03735643513363158 	ALA epochs: 11
Client: 19 	Std: 0.039327421762967066 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1426
Averaged Test Accurancy: 0.7894
Averaged Test AUC: 0.9646
Std Test Accurancy: 0.1957
Std Test AUC: 0.0344
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.415472745895386

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6629
Averaged Test Accurancy: 0.8036
Averaged Test AUC: 0.9687
Std Test Accurancy: 0.1831
Std Test AUC: 0.0338
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.041086196899414

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5534
Averaged Test Accurancy: 0.8227
Averaged Test AUC: 0.9721
Std Test Accurancy: 0.1598
Std Test AUC: 0.0323
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.173015117645264

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5134
Averaged Test Accurancy: 0.8319
Averaged Test AUC: 0.9740
Std Test Accurancy: 0.1476
Std Test AUC: 0.0314
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.101874828338623

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4835
Averaged Test Accurancy: 0.8369
Averaged Test AUC: 0.9750
Std Test Accurancy: 0.1462
Std Test AUC: 0.0306
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.351496934890747

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4607
Averaged Test Accurancy: 0.8419
Averaged Test AUC: 0.9758
Std Test Accurancy: 0.1419
Std Test AUC: 0.0298
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.127540111541748

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4439
Averaged Test Accurancy: 0.8474
Averaged Test AUC: 0.9764
Std Test Accurancy: 0.1375
Std Test AUC: 0.0293
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.206130981445312

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4299
Averaged Test Accurancy: 0.8526
Averaged Test AUC: 0.9767
Std Test Accurancy: 0.1316
Std Test AUC: 0.0291
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.32715129852295

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4187
Averaged Test Accurancy: 0.8553
Averaged Test AUC: 0.9767
Std Test Accurancy: 0.1303
Std Test AUC: 0.0292
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.226182222366333

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4089
Averaged Test Accurancy: 0.8586
Averaged Test AUC: 0.9772
Std Test Accurancy: 0.1286
Std Test AUC: 0.0283
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
self ewc lambda:0.1, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.130287408828735

Best accuracy.
0.8585804731756081

Average time cost per round.
11.210023784637452
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 126.65s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8585804731756081
global accuracy ++++++++++++++++++++:  0.8585804731756081
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 282685270 	Used Memory: 539.84M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=50, ewc_lambda=0.1, accuracy=0.8586
Testing with buffer_size=50, ewc_lambda=0.2
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.2, buffer_size=50, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3023
Averaged Test Accurancy: 0.1022
Averaged Test AUC: 0.5041
Std Test Accurancy: 0.1314
Std Test AUC: 0.2259
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.73436689376831
Client: 0 	Std: 0.02815760579244526 	ALA epochs: 11
Client: 1 	Std: 0.03750589124387778 	ALA epochs: 11
Client: 2 	Std: 0.055596532128788116 	ALA epochs: 11
Client: 3 	Std: 0.04842991834867814 	ALA epochs: 11
Client: 4 	Std: 0.029020524699660728 	ALA epochs: 11
Client: 5 	Std: 0.030071532362823703 	ALA epochs: 11
Client: 6 	Std: 0.059827728837308365 	ALA epochs: 11
Client: 7 	Std: 0.06317764861501858 	ALA epochs: 11
Client: 8 	Std: 0.043755803912130284 	ALA epochs: 11
Client: 9 	Std: 0.012468044533334941 	ALA epochs: 11
Client: 10 	Std: 0.09212855685159427 	ALA epochs: 11
Client: 11 	Std: 0.07243668974115562 	ALA epochs: 11
Client: 12 	Std: 0.048020761553242725 	ALA epochs: 11
Client: 13 	Std: 0.022787686271844555 	ALA epochs: 11
Client: 14 	Std: 0.04187418137668823 	ALA epochs: 11
Client: 15 	Std: 0.08126262745801324 	ALA epochs: 11
Client: 16 	Std: 0.054026141662547655 	ALA epochs: 11
Client: 17 	Std: 0.03666223931200904 	ALA epochs: 11
Client: 18 	Std: 0.03892218526252377 	ALA epochs: 11
Client: 19 	Std: 0.040460908891137536 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1502
Averaged Test Accurancy: 0.7673
Averaged Test AUC: 0.9642
Std Test Accurancy: 0.2038
Std Test AUC: 0.0344
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.605719804763794

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6579
Averaged Test Accurancy: 0.8015
Averaged Test AUC: 0.9686
Std Test Accurancy: 0.1806
Std Test AUC: 0.0331
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.869688510894775

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5518
Averaged Test Accurancy: 0.8179
Averaged Test AUC: 0.9718
Std Test Accurancy: 0.1671
Std Test AUC: 0.0325
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.546958923339844

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5102
Averaged Test Accurancy: 0.8288
Averaged Test AUC: 0.9736
Std Test Accurancy: 0.1526
Std Test AUC: 0.0314
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.155918598175049

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4863
Averaged Test Accurancy: 0.8335
Averaged Test AUC: 0.9746
Std Test Accurancy: 0.1480
Std Test AUC: 0.0311
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.22563624382019

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4664
Averaged Test Accurancy: 0.8401
Averaged Test AUC: 0.9754
Std Test Accurancy: 0.1444
Std Test AUC: 0.0303
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.480468511581421

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4497
Averaged Test Accurancy: 0.8477
Averaged Test AUC: 0.9760
Std Test Accurancy: 0.1375
Std Test AUC: 0.0298
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.909373760223389

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4367
Averaged Test Accurancy: 0.8520
Averaged Test AUC: 0.9760
Std Test Accurancy: 0.1341
Std Test AUC: 0.0295
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.817933082580566

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4232
Averaged Test Accurancy: 0.8536
Averaged Test AUC: 0.9764
Std Test Accurancy: 0.1336
Std Test AUC: 0.0292
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.741897583007812

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4128
Averaged Test Accurancy: 0.8568
Averaged Test AUC: 0.9769
Std Test Accurancy: 0.1318
Std Test AUC: 0.0288
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
self ewc lambda:0.2, Buffer size 50
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.724193572998047

Best accuracy.
0.8567810729756747

Average time cost per round.
11.607778859138488
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 130.81s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8567810729756747
global accuracy ++++++++++++++++++++:  0.8567810729756747
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 282685270 	Used Memory: 539.84M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=50, ewc_lambda=0.2, accuracy=0.8568
Testing with buffer_size=100, ewc_lambda=0.05
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.05, buffer_size=100, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3041
Averaged Test Accurancy: 0.1146
Averaged Test AUC: 0.5013
Std Test Accurancy: 0.1488
Std Test AUC: 0.2295
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.466793060302734
Client: 0 	Std: 0.07017875604556384 	ALA epochs: 12
Client: 1 	Std: 0.05330586041480652 	ALA epochs: 11
Client: 2 	Std: 0.05015527496514604 	ALA epochs: 11
Client: 3 	Std: 0.07172811235079915 	ALA epochs: 11
Client: 4 	Std: 0.03697443800104294 	ALA epochs: 11
Client: 5 	Std: 0.03190013219383375 	ALA epochs: 11
Client: 6 	Std: 0.0743193561531386 	ALA epochs: 12
Client: 7 	Std: 0.051948754909731436 	ALA epochs: 11
Client: 8 	Std: 0.019922102380941338 	ALA epochs: 11
Client: 9 	Std: 0.031817658855771036 	ALA epochs: 11
Client: 10 	Std: 0.09220302913684505 	ALA epochs: 11
Client: 11 	Std: 0.044996900372787814 	ALA epochs: 11
Client: 12 	Std: 0.04655006366669195 	ALA epochs: 11
Client: 13 	Std: 0.056569854993700895 	ALA epochs: 11
Client: 14 	Std: 0.04310056159859204 	ALA epochs: 11
Client: 15 	Std: 0.08828121329426475 	ALA epochs: 11
Client: 16 	Std: 0.04947366074433231 	ALA epochs: 11
Client: 17 	Std: 0.03621611264666153 	ALA epochs: 11
Client: 18 	Std: 0.04078350732788757 	ALA epochs: 11
Client: 19 	Std: 0.03941596196991839 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1165
Averaged Test Accurancy: 0.7704
Averaged Test AUC: 0.9626
Std Test Accurancy: 0.1882
Std Test AUC: 0.0388
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.490609884262085

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6657
Averaged Test Accurancy: 0.8039
Averaged Test AUC: 0.9686
Std Test Accurancy: 0.1838
Std Test AUC: 0.0359
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.330192565917969

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5473
Averaged Test Accurancy: 0.8238
Averaged Test AUC: 0.9720
Std Test Accurancy: 0.1634
Std Test AUC: 0.0344
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.731244802474976

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5050
Averaged Test Accurancy: 0.8307
Averaged Test AUC: 0.9737
Std Test Accurancy: 0.1522
Std Test AUC: 0.0327
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.630028486251831

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4749
Averaged Test Accurancy: 0.8372
Averaged Test AUC: 0.9752
Std Test Accurancy: 0.1463
Std Test AUC: 0.0309
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 10.21944808959961

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4580
Averaged Test Accurancy: 0.8409
Averaged Test AUC: 0.9759
Std Test Accurancy: 0.1418
Std Test AUC: 0.0303
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.825981140136719

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4420
Averaged Test Accurancy: 0.8473
Averaged Test AUC: 0.9766
Std Test Accurancy: 0.1358
Std Test AUC: 0.0296
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.720500707626343

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4258
Averaged Test Accurancy: 0.8526
Averaged Test AUC: 0.9771
Std Test Accurancy: 0.1331
Std Test AUC: 0.0288
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.568500757217407

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4133
Averaged Test Accurancy: 0.8555
Averaged Test AUC: 0.9777
Std Test Accurancy: 0.1309
Std Test AUC: 0.0282
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.697969675064087

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4051
Averaged Test Accurancy: 0.8584
Averaged Test AUC: 0.9779
Std Test Accurancy: 0.1300
Std Test AUC: 0.0279
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
self ewc lambda:0.05, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.484633684158325

Best accuracy.
0.85838053982006

Average time cost per round.
11.669910979270934
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 131.4s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.85838053982006
global accuracy ++++++++++++++++++++:  0.85838053982006
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 288831270 	Used Memory: 552.05M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=100, ewc_lambda=0.05, accuracy=0.8584
Testing with buffer_size=100, ewc_lambda=0.1
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.1, buffer_size=100, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3040
Averaged Test Accurancy: 0.0904
Averaged Test AUC: 0.4897
Std Test Accurancy: 0.1660
Std Test AUC: 0.2177
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.482979774475098
Client: 0 	Std: 0.06917477721163663 	ALA epochs: 11
Client: 1 	Std: 0.05877510271721991 	ALA epochs: 11
Client: 2 	Std: 0.07450539071228654 	ALA epochs: 11
Client: 3 	Std: 0.05815656318065656 	ALA epochs: 11
Client: 4 	Std: 0.03910925310446784 	ALA epochs: 11
Client: 5 	Std: 0.03645013920498523 	ALA epochs: 11
Client: 6 	Std: 0.08110944014443358 	ALA epochs: 12
Client: 7 	Std: 0.04316031510104617 	ALA epochs: 11
Client: 8 	Std: 0.06317932797032817 	ALA epochs: 11
Client: 9 	Std: 0.03269438556281166 	ALA epochs: 11
Client: 10 	Std: 0.08326884193367688 	ALA epochs: 11
Client: 11 	Std: 0.04609347101922173 	ALA epochs: 11
Client: 12 	Std: 0.03747173900617487 	ALA epochs: 11
Client: 13 	Std: 0.07602728153591212 	ALA epochs: 11
Client: 14 	Std: 0.046896977018072585 	ALA epochs: 11
Client: 15 	Std: 0.06060451474278624 	ALA epochs: 11
Client: 16 	Std: 0.027275136308045858 	ALA epochs: 11
Client: 17 	Std: 0.03283126099955432 	ALA epochs: 11
Client: 18 	Std: 0.03714307337207447 	ALA epochs: 11
Client: 19 	Std: 0.034840105436192134 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1076
Averaged Test Accurancy: 0.7806
Averaged Test AUC: 0.9641
Std Test Accurancy: 0.1906
Std Test AUC: 0.0395
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 19.314697265625

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6396
Averaged Test Accurancy: 0.8116
Averaged Test AUC: 0.9696
Std Test Accurancy: 0.1759
Std Test AUC: 0.0361
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.005932569503784

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5409
Averaged Test Accurancy: 0.8285
Averaged Test AUC: 0.9728
Std Test Accurancy: 0.1512
Std Test AUC: 0.0332
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.120981216430664

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5045
Averaged Test Accurancy: 0.8326
Averaged Test AUC: 0.9741
Std Test Accurancy: 0.1487
Std Test AUC: 0.0324
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.132546186447144

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4757
Averaged Test Accurancy: 0.8376
Averaged Test AUC: 0.9753
Std Test Accurancy: 0.1459
Std Test AUC: 0.0310
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.384723424911499

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4552
Averaged Test Accurancy: 0.8410
Averaged Test AUC: 0.9758
Std Test Accurancy: 0.1422
Std Test AUC: 0.0307
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.337490558624268

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4364
Averaged Test Accurancy: 0.8461
Averaged Test AUC: 0.9766
Std Test Accurancy: 0.1380
Std Test AUC: 0.0297
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.123812198638916

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4195
Averaged Test Accurancy: 0.8514
Averaged Test AUC: 0.9773
Std Test Accurancy: 0.1354
Std Test AUC: 0.0293
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.109994411468506

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4072
Averaged Test Accurancy: 0.8553
Averaged Test AUC: 0.9775
Std Test Accurancy: 0.1389
Std Test AUC: 0.0289
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.431537866592407

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.3973
Averaged Test Accurancy: 0.8621
Averaged Test AUC: 0.9780
Std Test Accurancy: 0.1282
Std Test AUC: 0.0284
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
self ewc lambda:0.1, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.526437282562256

Best accuracy.
0.8621126291236254

Average time cost per round.
11.248815298080444
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 127.27s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8621126291236254
global accuracy ++++++++++++++++++++:  0.8621126291236254
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 288831270 	Used Memory: 552.05M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=100, ewc_lambda=0.1, accuracy=0.8621
Testing with buffer_size=100, ewc_lambda=0.2
Inside iter +++++++++  Namespace(goal='test', device='cuda', device_id='0', dataset='Cifar10', num_classes=10, model='CNN', batch_size=10, local_learning_rate=0.005, learning_rate_decay=False, learning_rate_decay_gamma=0.99, global_rounds=10, local_epochs=1, algorithm='FedALA++', join_ratio=1.0, random_join_ratio=False, num_clients=20, prev=0, times=1, eval_gap=1, save_folder_name='items', auto_break=True, dlg_eval=False, dlg_gap=100, batch_num_per_client=2, num_new_clients=0, fine_tuning_epoch_new=0, feature_dim=512, vocab_size=32000, max_len=200, client_drop_rate=0.0, train_slow_rate=0.0, send_slow_rate=0.0, time_select=False, time_threthold=10000, beta=0.0, lamda=1.0, mu=0.0, K=5, p_learning_rate=0.01, M=5, itk=4000, alphaK=1.0, sigma=1.0, alpha=1.0, plocal_epochs=1, tau=1.0, fine_tuning_epochs=10, dr_learning_rate=0.0, L=1.0, noise_dim=512, generator_learning_rate=0.005, hidden_dim=512, server_epochs=1000, localize_feature_extractor=False, server_learning_rate=1.0, eta=1.0, rand_percent=80, layer_idx=2, mentee_learning_rate=0.005, T_start=0.95, T_end=0.98, momentum=0.1, kl_weight=0.0, ewc_lambda=0.2, buffer_size=100, grid_search=True, gr=10)
model ++++++++++++++ : CNN

============= Running time: 0th =============
Creating server and clients ...
.......................................................Hello 0
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ dataset name :  Cifar10
+++++++++++++++++++++++++++++++++++++++++++++++++++++++ model name :  CNN
+++++++++++ 1. inside cnn Fedavgcnn Cifar10
+++++++++++............................................................... Executing Cifar10 dataset
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)
Commons Config: {'common': None, 'parameter_tuning': False, 'algo_executing': 'FedALA'}

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........
I am inside FedALA++ with Uncertainty-Based Sampling ...........

-------------In FedALA++ Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3023
Averaged Test Accurancy: 0.1022
Averaged Test AUC: 0.5041
Std Test Accurancy: 0.1314
Std Test AUC: 0.2259
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 8.877126693725586
Client: 0 	Std: 0.0717923769610869 	ALA epochs: 11
Client: 1 	Std: 0.061719597598329 	ALA epochs: 11
Client: 2 	Std: 0.023189239563264772 	ALA epochs: 11
Client: 3 	Std: 0.047518883148052055 	ALA epochs: 11
Client: 4 	Std: 0.030290083872706305 	ALA epochs: 11
Client: 5 	Std: 0.019212291717229928 	ALA epochs: 11
Client: 6 	Std: 0.09574750882804464 	ALA epochs: 11
Client: 7 	Std: 0.032028334063818546 	ALA epochs: 11
Client: 8 	Std: 0.05389984458549463 	ALA epochs: 11
Client: 9 	Std: 0.02397493848336078 	ALA epochs: 11
Client: 10 	Std: 0.08443206213058153 	ALA epochs: 12
Client: 11 	Std: 0.05292541536831225 	ALA epochs: 11
Client: 12 	Std: 0.03896972868353 	ALA epochs: 11
Client: 13 	Std: 0.024910003530984014 	ALA epochs: 11
Client: 14 	Std: 0.03950991291590772 	ALA epochs: 11
Client: 15 	Std: 0.044620577735737584 	ALA epochs: 11
Client: 16 	Std: 0.05695030053798502 	ALA epochs: 11
Client: 17 	Std: 0.03668513333583369 	ALA epochs: 11
Client: 18 	Std: 0.03830405846671517 	ALA epochs: 11
Client: 19 	Std: 0.037392704461373535 	ALA epochs: 11

-------------In FedALA++ Round number: 1-------------

Evaluate global model
Averaged Train Loss: 1.1593
Averaged Test Accurancy: 0.7781
Averaged Test AUC: 0.9639
Std Test Accurancy: 0.1886
Std Test AUC: 0.0353
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 20.26250958442688

-------------In FedALA++ Round number: 2-------------

Evaluate global model
Averaged Train Loss: 0.6632
Averaged Test Accurancy: 0.8017
Averaged Test AUC: 0.9687
Std Test Accurancy: 0.1796
Std Test AUC: 0.0335
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.84850549697876

-------------In FedALA++ Round number: 3-------------

Evaluate global model
Averaged Train Loss: 0.5517
Averaged Test Accurancy: 0.8181
Averaged Test AUC: 0.9721
Std Test Accurancy: 0.1640
Std Test AUC: 0.0322
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.865556001663208

-------------In FedALA++ Round number: 4-------------

Evaluate global model
Averaged Train Loss: 0.5092
Averaged Test Accurancy: 0.8309
Averaged Test AUC: 0.9735
Std Test Accurancy: 0.1476
Std Test AUC: 0.0317
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.690587282180786

-------------In FedALA++ Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.4874
Averaged Test Accurancy: 0.8355
Averaged Test AUC: 0.9743
Std Test Accurancy: 0.1440
Std Test AUC: 0.0311
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.454107522964478

-------------In FedALA++ Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.4676
Averaged Test Accurancy: 0.8416
Averaged Test AUC: 0.9751
Std Test Accurancy: 0.1412
Std Test AUC: 0.0305
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.052372932434082

-------------In FedALA++ Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.4492
Averaged Test Accurancy: 0.8459
Averaged Test AUC: 0.9758
Std Test Accurancy: 0.1384
Std Test AUC: 0.0300
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.855610132217407

-------------In FedALA++ Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.4370
Averaged Test Accurancy: 0.8516
Averaged Test AUC: 0.9762
Std Test Accurancy: 0.1344
Std Test AUC: 0.0292
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.883848667144775

-------------In FedALA++ Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.4241
Averaged Test Accurancy: 0.8527
Averaged Test AUC: 0.9765
Std Test Accurancy: 0.1364
Std Test AUC: 0.0291
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 9.694907903671265

-------------In FedALA++ Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.4120
Averaged Test Accurancy: 0.8562
Averaged Test AUC: 0.9771
Std Test Accurancy: 0.1292
Std Test AUC: 0.0286
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
self ewc lambda:0.2, Buffer size 100
Global model updated with aggregated parameters
------------------------- time cost ------------------------- 11.380603790283203

Best accuracy.
0.8562479173608797

Average time cost per round.
11.698860931396485
File path: ../results/Cifar10_FedALA++_test_0.h5

Average time cost: 132.19s.
Length:  11
std for best accurancy: 0.0
mean for best accurancy: 0.8562479173608797
global accuracy ++++++++++++++++++++:  0.8562479173608797
All done!

Storage on cpu
-------------------------------------------------------------------------------
Total Tensors: 288831270 	Used Memory: 552.05M
-------------------------------------------------------------------------------

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 54571956 	Used Memory: 141.21M
The allocated memory on cuda:0: 158.08M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------
Result: buffer_size=100, ewc_lambda=0.2, accuracy=0.8562

Grid Search Results:
buffer_size=10, ewc_lambda=0.05, accuracy=0.8630
buffer_size=10, ewc_lambda=0.1, accuracy=0.8583
buffer_size=10, ewc_lambda=0.2, accuracy=0.8562
buffer_size=20, ewc_lambda=0.05, accuracy=0.8624
buffer_size=20, ewc_lambda=0.1, accuracy=0.8578
buffer_size=20, ewc_lambda=0.2, accuracy=0.8554
buffer_size=50, ewc_lambda=0.05, accuracy=0.8596
buffer_size=50, ewc_lambda=0.1, accuracy=0.8586
buffer_size=50, ewc_lambda=0.2, accuracy=0.8568
buffer_size=100, ewc_lambda=0.05, accuracy=0.8584
buffer_size=100, ewc_lambda=0.1, accuracy=0.8621
buffer_size=100, ewc_lambda=0.2, accuracy=0.8562

Best Parameters: buffer_size=10, ewc_lambda=0.05
Best Accuracy: 0.8630
